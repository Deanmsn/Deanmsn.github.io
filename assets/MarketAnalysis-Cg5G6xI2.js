import{g as C,m as v}from"./market-BWS4qXYb.js";import{m as S}from"./mockData-CMSpithW.js";import{d as k,g as b,h as G,c as p,a as e,t as a,F as m,k as P,o as y,_ as M}from"./index-fcQhomb6.js";const _={minPriceGap:10,minVolume:100,maxPrice:1e5,weightPriceGap:.4,weightVolume:.3,weightOrders:.3};function g(d,l=_,r=10){const c=[];return Object.entries(d).forEach(([o,s])=>{if(!s.buyOrders)return;const i=s.buyOrders.maxPrice,u=s.sellOrders?.minPrice||0,t=u-i;if(t<(l.minPriceGap||0)||i>(l.maxPrice||1/0)||s.buyOrders.totalCount<(l.minVolume||0))return;const n=Math.min(t/100,1),h=Math.min(s.buyOrders.totalCount/1e4,1),f=Math.min(s.buyOrders.orderCount/50,1),O=n*(l.weightPriceGap||.4)+h*(l.weightVolume||.3)+f*(l.weightOrders||.3);c.push({itemId:o,displayName:C(o),score:O,reason:x(s,t),details:{sellPrice:u,buyPrice:i,priceGap:t,buyVolume:s.buyOrders.totalCount,buyOrders:s.buyOrders.orderCount}})}),c.sort((o,s)=>s.score-o.score).slice(0,r)}function w(d,l=_,r=10){const c=[];return Object.entries(d).forEach(([o,s])=>{if(!s.sellOrders)return;const i=s.sellOrders.minPrice,u=s.buyOrders?.maxPrice||0,t=i-u;if(t<(l.minPriceGap||0)||i>(l.maxPrice||1/0)||s.sellOrders.totalCount<(l.minVolume||0))return;const n=Math.min(t/100,1),h=Math.min(s.sellOrders.totalCount/1e4,1),f=Math.min(s.sellOrders.orderCount/50,1),O=n*(l.weightPriceGap||.4)+h*(l.weightVolume||.3)+f*(l.weightOrders||.3);c.push({itemId:o,displayName:C(o),score:O,reason:I(s,t),details:{sellPrice:i,buyPrice:u,priceGap:t,sellVolume:s.sellOrders.totalCount,sellOrders:s.sellOrders.orderCount}})}),c.sort((o,s)=>s.score-o.score).slice(0,r)}function x(d,l){const r=[];return l>50?r.push("价格差距很大"):l>20&&r.push("价格差距较大"),d.buyOrders.totalCount>1e4?r.push("求购量很大"):d.buyOrders.totalCount>1e3&&r.push("求购量较大"),d.buyOrders.orderCount>20?r.push("求购订单很多"):d.buyOrders.orderCount>5&&r.push("求购订单较多"),r.join("，")||"价格合理，有一定交易量"}function I(d,l){const r=[];return l>50?r.push("价格差距很大"):l>20&&r.push("价格差距较大"),d.sellOrders.totalCount>1e4?r.push("出售量很大"):d.sellOrders.totalCount>1e3&&r.push("出售量较大"),d.sellOrders.orderCount>20?r.push("出售订单很多"):d.sellOrders.orderCount>5&&r.push("出售订单较多"),r.join("，")||"价格合理，有一定交易量"}const V={class:"market-analysis"},A={class:"header"},B=["disabled"],N={class:"analysis-section"},F={class:"analysis-table"},j={class:"analysis-section"},E={class:"analysis-table"},L=k({__name:"MarketAnalysis",setup(d){const l=b(!1),r=b([]),c=b([]),o=u=>u.toLocaleString(),s=async()=>{l.value=!0;try{const u=await v.getMarketPrice();u.code===200&&u.data.items&&i(u.data.items)}catch{console.log("使用模拟数据进行分析"),i(S)}l.value=!1},i=u=>{r.value=g(u,{},10),c.value=w(u,{},10)};return G(()=>{s()}),(u,t)=>(y(),p("div",V,[e("div",A,[t[0]||(t[0]=e("h1",null,"市场智能分析",-1)),e("button",{onClick:s,disabled:l.value},a(l.value?"分析中...":"重新分析"),9,B)]),e("div",N,[t[2]||(t[2]=e("h2",null,"🎯 最适合购入的商品 (前10名)",-1)),e("div",F,[e("table",null,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",null,"排名"),e("th",null,"商品名称"),e("th",null,"评分"),e("th",null,"最低出售价"),e("th",null,"最高求购价"),e("th",null,"价格差距"),e("th",null,"推荐理由")])],-1)),e("tbody",null,[(y(!0),p(m,null,P(r.value,(n,h)=>(y(),p("tr",{key:n.itemId},[e("td",null,a(h+1),1),e("td",null,a(n.displayName),1),e("td",null,a((n.score*100).toFixed(1))+"%",1),e("td",null,a(o(n.details.sellPrice||0)),1),e("td",null,a(o(n.details.buyPrice||0)),1),e("td",null,a(o(n.details.priceGap||0)),1),e("td",null,a(n.reason),1)]))),128))])])])]),e("div",j,[t[4]||(t[4]=e("h2",null,"💰 最适合出手的商品 (前10名)",-1)),e("div",E,[e("table",null,[t[3]||(t[3]=e("thead",null,[e("tr",null,[e("th",null,"排名"),e("th",null,"商品名称"),e("th",null,"评分"),e("th",null,"最低出售价"),e("th",null,"最高求购价"),e("th",null,"价格差距"),e("th",null,"推荐理由")])],-1)),e("tbody",null,[(y(!0),p(m,null,P(c.value,(n,h)=>(y(),p("tr",{key:n.itemId},[e("td",null,a(h+1),1),e("td",null,a(n.displayName),1),e("td",null,a((n.score*100).toFixed(1))+"%",1),e("td",null,a(o(n.details.sellPrice||0)),1),e("td",null,a(o(n.details.buyPrice||0)),1),e("td",null,a(o(n.details.priceGap||0)),1),e("td",null,a(n.reason),1)]))),128))])])])])]))}}),T=M(L,[["__scopeId","data-v-1c4679c6"]]);export{T as default};
